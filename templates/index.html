<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>World Cup Draw Simulator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-slate-900 text-slate-100">
  <div class="max-w-6xl mx-auto px-4 py-8">
    <!-- Header -->
    <header class="mb-8 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
      <div>
        <h1 class="text-3xl sm:text-4xl font-bold tracking-tight">
          World Cup Draw Simulator
        </h1>
        <p class="text-slate-300 mt-1">
          Click “Draw” to generate a new random World Cup group stage.
        </p>
      </div>

      <button
        id="drawBtn"
        class="inline-flex items-center justify-center rounded-xl bg-emerald-500 px-4 py-2 text-sm font-semibold text-slate-900 shadow-lg hover:bg-emerald-400 active:scale-[0.98] transition"
      >
        Draw
      </button>
    </header>

    <!-- Status / error message -->
    <p id="statusText" class="text-sm text-slate-300 mb-4"></p>

    <!-- Groups grid -->
    <main>
      <div
        id="groupsContainer"
        class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3"
      >
        <!-- Cards will be inserted here -->
      </div>
    </main>
  </div>

  <script>
    const groupLetters = "ABCDEFGHIJKL".split("");

    function renderGroups(groups) {
      const container = document.getElementById("groupsContainer");
      container.innerHTML = "";

      groups.forEach((teams, index) => {
        const groupName = groupLetters[index] || `?`;

        const card = document.createElement("article");
        card.className =
          "rounded-2xl border border-slate-700 bg-slate-800/70 p-4 shadow-lg flex flex-col gap-3";

        const title = document.createElement("h2");
        title.className = "text-lg font-semibold text-slate-50";
        title.textContent = `Group ${groupName}`;

        const list = document.createElement("ul");
        list.className = "mt-1 space-y-1 text-sm";

        teams.forEach((team, i) => {
          const li = document.createElement("li");
          li.className =
            "flex items-center gap-2 rounded-lg bg-slate-900/40 px-3 py-1.5";

          const badge = document.createElement("span");
          badge.className =
            "inline-flex h-6 w-6 items-center justify-center rounded-full bg-slate-700 text-xs font-semibold text-slate-100";
          badge.textContent = i + 1;

          const name = document.createElement("span");
          name.textContent = team ?? "-";

          li.appendChild(badge);
          li.appendChild(name);
          list.appendChild(li);
        });

        card.appendChild(title);
        card.appendChild(list);
        container.appendChild(card);
      });
    }

    async function fetchDraw() {
      const status = document.getElementById("statusText");
      status.textContent = "Drawing...";

      try {
        const response = await fetch("/api/draw");
        if (!response.ok) {
          throw new Error("Server error: " + response.status);
        }
        const data = await response.json();
        renderGroups(data);
        status.textContent = "Draw completed.";
      } catch (err) {
        console.error(err);
        status.textContent = "Error: could not fetch draw.";
      }
    }

    document.getElementById("drawBtn").addEventListener("click", fetchDraw);
  </script>
</body>
</html>
